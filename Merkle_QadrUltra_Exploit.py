import hashlib
import os
import sys
import time
import subprocess

# ألوان الواجهة الاحترافية
R = '\033[31m'; G = '\033[32m'; C = '\033[36m'; Y = '\033[33m'; W = '\033[0m'

class MerkleExploit:
    def __init__(self):
        self.version = "V2.0 - Ultra"
        self.target_algorithm = "MD5/SHA-1 (Merkle-Damgård)"

    def banner(self):
        os.system('clear' if os.name == 'posix' else 'cls')
        print(f"""
{R}  __  __ ______ _____  _  ___      ______ 
 |  \/  |  ____|  __ \| |/ / |    |  ____|
 | \  / | |__  | |__) | ' /| |    | |__   
 | |\/| |  __| |  _  /|  < | |    |  __|  
 | |  | | |____| | \ \| . \| |____| |____ 
 |_|  |_|______|_|  \_\_|\_\______|______|
 {Y}       GRADUATION PROJECT - HIGH RISK DEMO {W}
 {C} Connection: QadrUltra-Framework | Branch: Advanced {W}
        """)

    def theoretical_shout(self):
        print(f"{Y}[THEORY]{W} Merkle-Damgård vulnerability allows 'Length Extension' and 'Collisions'.")
        print(f"{Y}[RISK]{W} An attacker can append malicious data to a signed file without breaking the hash signature.")
        time.sleep(2)

    def practical_attack(self):
        print(f"\n{C}[*] Initiating Practical Collision...{W}")
        # 1. إنشاء ملف "البرنامج السليم"
        with open("App_Safe.bin", "wb") as f:
            f.write(b"Original_Logic_Safe_And_Secure")
        
        # 2. إنشاء ملف "البرنامج الخبيث"
        with open("App_Malicious.bin", "wb") as f:
            f.write(b"Original_Logic_Safe_And_Secure" + b"\x00"*64 + b"PAYLOAD_EXECUTED")

        # حساب الهاش للملفين
        h1 = hashlib.md5(open("App_Safe.bin","rb").read()).hexdigest()
        h2 = hashlib.md5(open("App_Malicious.bin","rb").read()).hexdigest()

        print(f"{G}[+] File 1 (Safe) MD5: {h1}{W}")
        print(f"{R}[+] File 2 (Malicious) MD5: {h2}{W}")
        
        print(f"\n{Y}[!] Notice: In a real 'Chosen Prefix' attack, these hashes would be identical.{W}")
        print(f"{C}[*] Creating Symbolic Link for Git development...{W}")

    def git_prep(self):
        """تجهيز الملفات ليتم رفعها على Git مباشرة"""
        print(f"\n{G}[+]{W} Generating .gitignore and README for GitHub...")
        with open("README.md", "w") as f:
            f.write(f"# Merkle Attack Module\nThis is a professional proof-of-concept for Merkle-Damgård collision attacks.")
        
        with open(".gitignore", "w") as f:
            f.write("*.bin\n__pycache__/\n")
        print(f"{G}[SUCCESS]{W} Repository files prepared.")

    def menu(self):
        while True:
            self.banner()
            print(f"1) {C}Theoretical Logic{W} (شرح المبدأ)")
            print(f"2) {C}Live Collision Demo{W} (توليد ملفات)")
            print(f"3) {C}Git/Development Prep{W} (تجهيز للرفع)")
            print(f"4) {R}Exit{W}")
            
            cmd = input(f"\n{G}SULTAN@QADR_LAB:{W}# ")
            
            if cmd == '1': self.theoretical_shout(); input("\nEnter to continue...")
            elif cmd == '2': self.practical_attack(); input("\nEnter to continue...")
            elif cmd == '3': self.git_prep(); input("\nEnter to continue...")
            elif cmd == '4': break

if __name__ == "__main__":
    app = MerkleExploit()
    app.menu()
# 1. جلب التحديثات من المستودع
git pull origin main

# 2. في حال وجود تعارض، قم بفرض التحديث (استخدم هذا بحذر)
git add .
git commit -m "Fixing sync issues"
git push origin main
Merkle_QadrUltra_Exploit.py
